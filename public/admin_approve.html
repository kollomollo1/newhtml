<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>تأكيد الصور من الأدمن</title>
  <style>
    body { font-family: 'Cairo', sans-serif; direction: rtl; padding: 20px; background: #f4f4f4; }
    .imageBox {
      display: inline-block;
      margin: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      overflow: hidden;
      background: white;
      width: 200px;
      vertical-align: top;
      text-align: center;
    }
    .imageBox img { width: 100%; height: 160px; object-fit: cover; }
    button { margin: 5px; padding: 6px 10px; border: none; border-radius: 4px; cursor: pointer; }
    .approve { background: green; color: white; }
    .reject { background: red; color: white; }
  </style>
</head>
<body>
  <h2>الصور بانتظار التأكيد</h2>
  <div id="pendingContainer"></div>
  <script>
    const container = document.getElementById("pendingContainer");

    fetch("https://gallery3modifiedjsless-default-rtdb.europe-west1.firebasedatabase.app/pending_images.json")
      .then(res => res.json())
      .then(data => {
        if (!data) return container.innerHTML = "<p>لا توجد صور حالياً.</p>";

        Object.entries(data).forEach(([key, img]) => {
          const box = document.createElement("div");
          box.className = "imageBox";

          const image = document.createElement("img");
          image.src = img.src;

          const info = document.createElement("p");
          info.innerHTML = `<strong>بائع:</strong> ${img.trader}<br><strong>تصنيف:</strong> ${img.category}`;

          const approveBtn = document.createElement("button");
          approveBtn.className = "approve";
          approveBtn.textContent = "تأكيد";
          approveBtn.onclick = () => {
            fetch("https://gallery3modifiedjsless-default-rtdb.europe-west1.firebasedatabase.app/images.json", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(img)
            }).then(() => {
              return fetch("https://gallery3modifiedjsless-default-rtdb.europe-west1.firebasedatabase.app/pending_images/" + key + ".json", {
                method: "DELETE"
              });
            }).then(() => {
              box.remove();
            });
          };

          const rejectBtn = document.createElement("button");
          rejectBtn.className = "reject";
          rejectBtn.textContent = "رفض";
          rejectBtn.onclick = () => {
            fetch("https://gallery3modifiedjsless-default-rtdb.europe-west1.firebasedatabase.app/pending_images/" + key + ".json", {
              method: "DELETE"
            }).then(() => {
              box.remove();
            });
          };

          box.appendChild(image);
          box.appendChild(info);
          box.appendChild(approveBtn);
          box.appendChild(rejectBtn);

          container.appendChild(box);
        });
      });
  </script>
</body>
</html>
